<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Screams of Oblivion</title>
  <link rel="stylesheet" href="main.css">
  <link href="https://fonts.googleapis.com/css2?family=UnifrakturCook:wght@700&display=swap" rel="stylesheet">
</head>
<body>
  <header>
    <div class="header-left">
      <div class="logo" aria-hidden="true"></div>
      <div class="nomepequeno">
        <h5>
          <span>Screams</span><br>
          <span>of</span><br>
          <span>Oblivion</span>
        </h5>
      </div>
    </div>

    <nav class="navegacaoheader">
      <a href="#" class="playnow">Play Now</a>
      <a href="login.html" class="loginlink">Log In</a>
    </nav>
  </header>

  <main>
    <section class="hero" style="background-image: url('images/hero.jpg'); background-size:cover; background-position:center;">
      <div class="hero-overlay"></div>
      <div class="titulo">
        <h1>
          <span>Screams</span><br>
          <span>of</span><br>
          <span>Oblivion</span>
        </h1>
        <p class="lead">A gothic strategy experience — face your doom.</p>
        <div class="hero-ctas">
          <a href="#" class="playnow">Play Now</a>
          <a href="login.html" class="loginlink">Sign In</a>
        </div>
      </div>
    </section>

    <div class="cards">
      <div class="card" data-full="images/full1.jpg">
        <img src="images/thumb1.jpg" alt="thumb 1">
      </div>
      <div class="card" data-full="images/full2.jpg">
        <img src="images/thumb2.jpg" alt="thumb 2">
      </div>
      <div class="card" data-full="images/full3.jpg">
        <img src="images/thumb3.jpg" alt="thumb 3">
      </div>
      <div class="card" data-full="images/full4.jpg">
        <img src="images/thumb4.jpg" alt="thumb 4">
      </div>
    </div>

    <div id="preview" aria-hidden="true">
      <button id="preview-close" aria-label="Close preview">×</button>
    </div>

    <!-- modal for pinned image open -->
    <div id="modal" role="dialog" aria-hidden="true">
      <button id="modal-close" aria-label="Close">×</button>
      <div id="modal-img" aria-hidden="true"></div>
    </div>

    <script>
      // Hover preview + modal: show full image in #preview. Click to pin; click preview to open modal.
      const preview = document.getElementById('preview');
      const previewClose = document.getElementById('preview-close');
      const modal = document.getElementById('modal');
      const modalClose = document.getElementById('modal-close');
      const modalImg = document.getElementById('modal-img');
      let pinned = false;
      let currentSrc = null;
      let lastFocused = null;

      function showPreview(src) {
        if (!src) return;
        currentSrc = src;
        preview.style.backgroundImage = `url('${src}')`;
        preview.classList.add('visible');
        preview.setAttribute('aria-hidden', 'false');
      }
      function hidePreview() {
        if (pinned) return;
        preview.classList.remove('visible');
        preview.setAttribute('aria-hidden', 'true');
      }

      function openModal(src) {
        if (!src) return;
        modalImg.style.backgroundImage = `url('${src}')`;
        modal.classList.add('open');
        modal.setAttribute('aria-hidden', 'false');
        lastFocused = document.activeElement;
        modalClose.focus();
        document.body.style.overflow = 'hidden';
      }

      function closeModal() {
        modal.classList.remove('open');
        modal.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = ''; // restore scroll
        if (lastFocused) lastFocused.focus();
      }

      document.querySelectorAll('.card').forEach(card => {
        const src = card.dataset.full;
        card.addEventListener('mouseenter', () => showPreview(src));
        card.addEventListener('mouseleave', hidePreview);
        card.addEventListener('click', () => {
          pinned = !pinned;
          preview.classList.toggle('visible', pinned);
          preview.setAttribute('aria-hidden', pinned ? 'false' : 'true');
        });
      });

      // clicking the preview opens the modal if visible
      preview.addEventListener('click', (e) => {
        if (preview.classList.contains('visible')) {
          openModal(currentSrc);
        }
      });

      previewClose.addEventListener('click', () => {
        pinned = false;
        preview.classList.remove('visible');
        preview.setAttribute('aria-hidden', 'true');
      });

      modalClose.addEventListener('click', closeModal);

      // keyboard: Escape closes modal or unpins preview
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          if (modal.classList.contains('open')) {
            closeModal();
          } else if (preview.classList.contains('visible')) {
            pinned = false;
            preview.classList.remove('visible');
            preview.setAttribute('aria-hidden', 'true');
          }
        }
      });

      // Simulate login/register: intercept form submits and redirect to mainlogged.html
      const loginForm = document.querySelector('.auth-form');
      if (loginForm) {
        loginForm.addEventListener('submit', function (e) {
          e.preventDefault();
          window.location.href = 'mainlogged.html';
        });
      }
    </script>
  </main>
</body>
</html>
